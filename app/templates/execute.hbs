{{#ember-wormhole to="deck-picker"}}
  {{deck-picker data=decks store=store activeDeck=activeDeck setActiveDeck=(action "setActiveDeck")}}
{{/ember-wormhole}}

<div class="container">
  {{#if session.currentUser.show_help}}
    <div class="jumbotron">
      <h2 class="text-center">Execute</h2>
      <p class="text-center">
      <small>Do whatever you can off the top of your list.</small>
      </p>
    </div>
  {{/if}}

  <div class="progress">
    <div class="progress-bar progress-bar-info progress-bar-striped" role="progressbar" aria-valuenow="{{await percentCompleted}}" aria-valuemin="0" aria-valuemax="100" style="width: {{await percentCompleted}}%;">
      <span class="sr-only">{{await percentCompleted}}% Complete</span>
    </div>
  </div>

  <div>
    {{#each filteredTasks as |task|}}
      {{#liquid-if (await task.readyToExecute) class="task-animation"}}
        {{#unless task.isCompleted}}
          {{#if task.hasAfters}}
            <div class="shadow-stack well"></div>
            <div class="shadow-stack well"></div>
            <div class="shadow-stack well"></div>
            <div class="shadow-stack well"></div>
          {{/if}}
        {{/unless}}
        <div class="task-card well clickable {{if task.focused 'focused'}} {{if task.pendingCompletion 'completed'}}" {{action "focusTask" task on="click"}} data-task-id="{{task.id}}">
          <div class="actions btn-group">
            <button class="btn btn-default" disabled={{task.isCompleted}} {{action 'complete' task}} aria-label="complete">
              complete
            </button>
          </div>
          {{task.title}}
          {{#if task.focused}}
            {{#if task.details}}
              <hr>
              <div>
                {{markdown-to-html task.details}}
              </div>
            {{/if}}
          {{/if}}
        </div>
      {{/liquid-if}}
    {{/each}}
  </div>
</div>

{{add-task-modal store=store}}
{{cartoon-modal kind="execute"}}
