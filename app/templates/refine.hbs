<div class="container">
  {{cartoon-modal kind="refine" help=session.currentUser.show_help_refine}}

  {{#if showTimer}}
    {{countdown-timer duration=300 timerDone=(action 'timerDone') task=activeTask done=(action 'done') defer=(action 'defer')}}
  {{/if}}

  {{#if activeTask}}
    <div class="action-area well">
      <div class="task-card well">
        <div class="actions btn-group">
          <button class="btn btn-default" disabled={{showTimer}} {{action 'do' activeTask}} aria-label="do">
            do
          </button>
          <button class="btn btn-default" disabled={{showTimer}} {{action 'defer' activeTask}} aria-label="defer">
            defer
          </button>
          <button class="btn btn-default" disabled={{showTimer}} {{action 'destroy' activeTask}} aria-label="destroy">
            destroy
          </button>
        </div>
        {{activeTask.title}}
        {{textarea value=activeTask.details class="form-control" rows=3 placeholder="Details..." focus-out="saveDetails"}}
      </div>
    </div>
  {{/if}}

  <div class="row">
    <div class="messy-stack col-md-6 col-md-offset-3">
      {{#each inactiveTasks as |task index|}}
        <div class="task-card well clickable" style="z-index: {{math 1000 "-" index}}" {{action "makeActive" task on="click"}}>
          {{task.title}}
        </div>
      {{/each}}
    </div>
  </div>
</div>

{{add-task-modal}}
